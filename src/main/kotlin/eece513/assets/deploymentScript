file="servers.txt" 
count=1
while IFS='' read -r line; do
	#terminate previous running server
	ssh -i Ubuntu1.pem ec2-user@"$line" 'pkill -9 -f distributed-grep-1.0-SNAPSHOT.jar'
	
	# log files 
	#scp -i Ubuntu1.pem message."$count".log ec2-user@"$line":/home/ec2-user
	#((count++))
	
	# server list
	#scp -i Ubuntu1.pem servers.txt ec2-user@"$line":/home/ec2-user
	# jar files 
	#scp -i Ubuntu1.pem build/libs/distributed-grep-1.0-SNAPSHOT.jar ec2-user@"$line":/home/ec2-user

	# start files
	#scp -i Ubuntu1.pem startServer.sh ec2-user@"$line":/home/ec2-user
	#scp -i Ubuntu1.pem startClient.sh ec2-user@"$line":/home/ec2-user
	
	echo "$line"	
	# start server jar file
	#ssh -i Ubuntu1.pem ec2-user@"$line" 'nohup java -cp ~/distributed-grep-1.0-SNAPSHOT.jar eece513.server.GrepServer & exit' 
	ssh -i Ubuntu1.pem ec2-user@"$line" 'bash startServer.sh & exit'
done <"$file" 
